(function(){"use strict";var e={1140:function(e,s,t){var o=t(9242),a=t(3396),n=t(7139);const i={class:"wrapper"},l={class:"left-panel"},r=["onClick","title"],d={class:"groups-panel"},c={class:"actions-panel"},u={class:"list list-group"},p=["onClick"],m={class:"title-panel"},k={class:"title"},b={class:"actions-panel"},f={class:"task-filter"},_=(0,a._)("button",{class:"btn"},[(0,a._)("i",{class:"bi bi-filter"}),(0,a.Uk)("Фильтр")],-1),w={class:"tasks-panel"},h={class:"block-name"},v={class:"title"},g=["onClick","innerHTML"];function y(e,s,t,y,S,D){const T=(0,a.up)("dropdown"),R=(0,a.up)("draggable_tasks_list"),C=(0,a.up)("edit_task_window"),I=(0,a.up)("edit_block_window"),F=(0,a.up)("edit_group_window"),G=(0,a.up)("repo_window"),W=(0,a.up)("saved_toast"),L=(0,a.up)("loader");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",i,[(0,a._)("div",l,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(S.aMenu,((e,s)=>((0,a.wg)(),(0,a.iD)("button",{key:s,class:"btn",onClick:s=>D.fnClickLeftMenu(e),title:e.title},[(0,a._)("i",{class:(0,n.C_)("bi "+e.icon)},null,2)],8,r)))),128))]),"tasks"==e.sMode?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("div",d,[(0,a._)("div",c,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=e=>S.sGroupsFilter=e)},null,512),[[o.nr,S.sGroupsFilter]]),(0,a.Wm)(T,{items:S.aGroupsDropdownMenu,onClickitem:D.fnGroupClickItem},null,8,["items","onClickitem"])]),(0,a._)("div",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(D.aGroups,((s,t)=>((0,a.wg)(),(0,a.iD)("button",{key:t,type:"button",class:(0,n.C_)("list-group-item list-group-item-action "+(s.id==e.sSelectedGroupID?"active":"")),onClick:t=>e.fnSelectGroup(s.id),"aria-current":"true"},(0,n.zw)(s.name),11,p)))),128))])]),e.oCurrentGroup?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"tasks-panel-wrapper",style:(0,n.j5)({background:e.oCurrentGroup.color})},[(0,a._)("div",m,[(0,a._)("div",k,(0,n.zw)(e.oCurrentGroup.name),1),(0,a._)("div",b,[(0,a._)("div",f,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=s=>e.sTasksFilter=s)},null,512),[[o.nr,e.sTasksFilter]])]),_,(0,a.Wm)(T,{items:S.aGroupsOptionsDropdownMenu,onClickitem:D.fnGroupOptionsClickItem,cls:"drop-menu-left"},null,8,["items","onClickitem"])])]),(0,a._)("div",w,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.aCurrentGroupBlocks,((e,s)=>((0,a.wg)(),(0,a.iD)("div",{key:s,class:"block-panel"},[(0,a._)("div",h,[(0,a._)("div",v,(0,n.zw)(e.name),1),(0,a.Wm)(T,{items:S.aBlockDropdownMenu,cls:"drop-menu-left",onClickitem:s=>D.fnBlockClickItem(s,e)},null,8,["items","onClickitem"])]),(0,a.Wm)(R,{block_id:e.id},null,8,["block_id"])])))),128))])],4)):(0,a.kq)("",!0)],64)):(0,a.kq)("",!0)]),(0,a.Wm)(C),(0,a.Wm)(I),(0,a.Wm)(F),(0,a.Wm)(G),(0,a.Wm)(W),(0,a._)("ul",{ref:"task_menu",class:(0,n.C_)("dropdown-menu task-menu "+(e.bShowTaskMenu?"show":"")),style:(0,n.j5)({top:e.sTaskMenuY+"px",left:e.sTaskMenuX+"px"})},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(S.aTasksDropdownMenu,(e=>((0,a.wg)(),(0,a.iD)("li",{key:e.id},[(0,a._)("a",{class:"dropdown-item",href:"#",onClick:s=>D.fnTaskClickItem(e),innerHTML:e.title},null,8,g)])))),128))],6),(0,a.Wm)(L)],64)}const S={class:"block-tasks list list-group"},D={class:"title"},T={class:"description"},R={class:"actions-panel"},C=["onClick"],I=(0,a._)("i",{class:"bi bi-pencil"},null,-1),F=[I];function G(e,s,t,o,i,l){const r=(0,a.up)("draggable");return(0,a.wg)(),(0,a.iD)("div",S,[(0,a.Wm)(r,{modelValue:l.aTasks,"onUpdate:modelValue":s[0]||(s[0]=e=>l.aTasks=e),"item-key":"id",group:"people","ghost-class":"ghost",onStart:s[1]||(s[1]=e=>i.drag=!0),onEnd:s[2]||(s[2]=e=>i.drag=!1),sort:!0},{item:(0,a.w5)((({element:s})=>[(0,a._)("div",{type:"button",class:(0,n.C_)("list-card "+(s.id==e.sSelectedTaskID?"active":"")),"aria-current":"true"},[s.use_color?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"task-color",style:(0,n.j5)({background:s.color})},null,4)):(0,a.kq)("",!0),(0,a._)("div",D,(0,n.zw)(s.name),1),(0,a._)("div",T,(0,n.zw)(s.short_description),1),(0,a._)("div",R,[(0,a._)("div",{class:"btn",onClick:e=>l.fnClickItem(e,s)},F,8,C)])],2)])),_:1},8,["modelValue"])])}var W=t(6983),L=t.n(W);const O={class:"dropdown"},E=(0,a._)("i",{class:"bi bi-three-dots-vertical"},null,-1),x=[E],U=["onClick","innerHTML"];function B(e,s,t,o,i,l){return(0,a.wg)(),(0,a.iD)("div",O,[(0,a._)("a",{class:"btn dropdown-toggle",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",onClick:s[0]||(s[0]=(...e)=>l.fnMenuOpen&&l.fnMenuOpen(...e))},x),(0,a._)("ul",{class:(0,n.C_)("dropdown-menu "+(t.cls??"")+" "+(i.bOpened?"show":""))},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.aItems,(e=>((0,a.wg)(),(0,a.iD)("li",{key:e.id},[(0,a._)("a",{class:"dropdown-item",href:"#",onClick:s=>l.fnOnItemClick(e),innerHTML:e.title},null,8,U)])))),128))],2)])}var M={props:["items","cls"],emits:["clickitem"],data(){return{aItems:this.items,bOpened:!1}},methods:{fnFocusOut(){this.bOpened=!1},fnMenuOpen(){this.bOpened=!this.bOpened},fnOnItemClick(e){this.bOpened=!1,this.$emit("clickitem",e)}},created(){window.addEventListener("click",(e=>{this.$el.contains(e.target)||(this.bOpened=!1)}))}},N=t(89);const H=(0,N.Z)(M,[["render",B]]);var V=H,P=t(65);function Y(e){return e[0].split(" ")}function A(e){return{[e]:{get(){return this.$store.state[e]},set(s){this.$store.commit("fnUpdateVar",{sName:e,sV:s})}}}}function j(e){var s={},t=e.split(" ");for(var o of t)s=Object.assign(s,A(o));return s}function J(e,s){var t="data:text/json;charset=utf-8,"+encodeURIComponent(s),o=document.createElement("A");o.setAttribute("href",t),o.setAttribute("download",`${e}_${(new Date).getTime()}.json`),o.click(),o.remove()}var z={components:{draggable:L(),dropdown:V},emits:["clickedititem"],props:["block_id"],computed:{...j("sSelectedTaskID bShowTaskMenu sTaskMenuX sTaskMenuY oMenuTask"),aTasks:{get(){return this.$store.getters.fnGetBlockTasks(this.block_id)},set(e){this.$store.commit("fnUpdateTasksListForBlock",{sBlockID:this.block_id,aList:e})}}},data(){return{drag:!1}},methods:{...(0,P.OI)(Y`fnOpenTaskEditWindow fmRemoveTask`),fnClickItem(e,s){var t=e.target.getBoundingClientRect();this.sTaskMenuX=t.x,this.sTaskMenuY=t.y+t.height,this.oMenuTask=s,this.bShowTaskMenu=!0,e.stopPropagation()}}};const K=(0,N.Z)(z,[["render",G]]);var Z=K;const $=(0,a._)("div",{class:"block-overlay"},null,-1),q={class:"modal show",id:"modal-edit-category",tabindex:"-1"},X={class:"modal-dialog"},Q={class:"modal-content"},ee={class:"modal-header"},se=(0,a._)("h5",{class:"modal-title"},"Редактирование задачи",-1),te={class:"modal-body"},oe={class:"mb-3"},ae={for:"",class:"form-label"},ne={class:"mb-3"},ie=(0,a._)("label",{for:"",class:"form-label"},"Название",-1),le={class:"mb-3"},re=(0,a._)("label",{for:"",class:"form-label"},"Краткое описание",-1),de={class:"mb-3"},ce=(0,a._)("label",{for:"",class:"form-label"},"Полное описание",-1),ue={class:"mb-3"},pe={for:"",class:"form-label"},me={class:"modal-footer"};function ke(e,s,t,i,l,r){return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",null,[$,(0,a._)("div",q,[(0,a._)("div",X,[(0,a._)("div",Q,[(0,a._)("div",ee,[se,(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:s[0]||(s[0]=(...e)=>r.fnClose&&r.fnClose(...e))})]),(0,a._)("div",te,[(0,a._)("div",oe,[(0,a._)("label",ae,"Блок: "+(0,n.zw)(e.sTaskBlockName),1)]),(0,a._)("div",ne,[ie,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=s=>e.sTaskName=s)},null,512),[[o.nr,e.sTaskName]])]),(0,a._)("div",le,[re,(0,a.wy)((0,a._)("textarea",{rows:"10",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=s=>e.sTaskShortDescription=s)},null,512),[[o.nr,e.sTaskShortDescription]])]),(0,a._)("div",de,[ce,(0,a.wy)((0,a._)("textarea",{rows:"10",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=s=>e.sTaskFullDescription=s)},null,512),[[o.nr,e.sTaskFullDescription]])]),(0,a._)("div",ue,[(0,a._)("label",pe,[(0,a.wy)((0,a._)("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=s=>e.sTaskUseColor=s)},null,512),[[o.e8,e.sTaskUseColor]]),(0,a.Uk)(" Цвет")]),(0,a.wy)((0,a._)("input",{type:"color",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=s=>e.sTaskColor=s)},null,512),[[o.nr,e.sTaskColor]])])]),(0,a._)("div",me,[(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:s[6]||(s[6]=(...e)=>r.fnClose&&r.fnClose(...e))},"Отмена"),(0,a._)("button",{id:"category-edit-save",type:"button",class:"btn btn-success",onClick:s[7]||(s[7]=(...e)=>r.fnSave&&r.fnSave(...e))},"Сохранить")])])])])],512)),[[o.F8,e.bShowTaskEditWindow]])}var be={props:{},computed:{...j("bShowTaskEditWindow sTaskBlockName sTaskUseColor sTaskName sTaskShortDescription sTaskFullDescription sTaskColor")},data(){return{}},methods:{...(0,P.OI)(Y`fnSaveTask`),fnSave(){this.fnSaveTask(),this.bShowTaskEditWindow=!1},fnClose(){this.bShowTaskEditWindow=!1}}};const fe=(0,N.Z)(be,[["render",ke]]);var _e=fe;const we=(0,a._)("div",{class:"block-overlay"},null,-1),he={class:"modal show",id:"modal-edit-category",tabindex:"-1"},ve={class:"modal-dialog"},ge={class:"modal-content"},ye={class:"modal-header"},Se=(0,a._)("h5",{class:"modal-title"},"Редактирование блока",-1),De={class:"modal-body"},Te={class:"mb-3"},Re=(0,a._)("label",{for:"",class:"form-label"},"Название",-1),Ce={class:"modal-footer"};function Ie(e,s,t,n,i,l){return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",null,[we,(0,a._)("div",he,[(0,a._)("div",ve,[(0,a._)("div",ge,[(0,a._)("div",ye,[Se,(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:s[0]||(s[0]=(...e)=>l.fnClose&&l.fnClose(...e))})]),(0,a._)("div",De,[(0,a._)("div",Te,[Re,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=s=>e.sBlockName=s)},null,512),[[o.nr,e.sBlockName]])])]),(0,a._)("div",Ce,[(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:s[2]||(s[2]=(...e)=>l.fnClose&&l.fnClose(...e))},"Отмена"),(0,a._)("button",{id:"category-edit-save",type:"button",class:"btn btn-success",onClick:s[3]||(s[3]=(...e)=>l.fnSave&&l.fnSave(...e))},"Сохранить")])])])])],512)),[[o.F8,e.bShowBlockEditWindow]])}var Fe={props:{},computed:{...j("bShowBlockEditWindow sBlockName")},data(){return{}},methods:{...(0,P.OI)(Y`fnSaveBlock`),fnSave(){this.fnSaveBlock(),this.bShowBlockEditWindow=!1},fnClose(){this.bShowBlockEditWindow=!1}}};const Ge=(0,N.Z)(Fe,[["render",Ie]]);var We=Ge;const Le=(0,a._)("div",{class:"block-overlay"},null,-1),Oe={class:"modal show",id:"modal-edit-category",tabindex:"-1"},Ee={class:"modal-dialog"},xe={class:"modal-content"},Ue={class:"modal-header"},Be=(0,a._)("h5",{class:"modal-title"},"Редактирование задачи",-1),Me={class:"modal-body"},Ne={class:"mb-3"},He=(0,a._)("label",{for:"",class:"form-label"},"Название",-1),Ve={class:"mb-3"},Pe=(0,a._)("label",{for:"",class:"form-label"},"Цвет",-1),Ye={class:"modal-footer"};function Ae(e,s,t,n,i,l){return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",null,[Le,(0,a._)("div",Oe,[(0,a._)("div",Ee,[(0,a._)("div",xe,[(0,a._)("div",Ue,[Be,(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:s[0]||(s[0]=(...e)=>l.fnClose&&l.fnClose(...e))})]),(0,a._)("div",Me,[(0,a._)("div",Ne,[He,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=s=>e.sGroupName=s)},null,512),[[o.nr,e.sGroupName]])]),(0,a._)("div",Ve,[Pe,(0,a.wy)((0,a._)("input",{type:"color",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=s=>e.sGroupColor=s)},null,512),[[o.nr,e.sGroupColor]])])]),(0,a._)("div",Ye,[(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:s[3]||(s[3]=(...e)=>l.fnClose&&l.fnClose(...e))},"Отмена"),(0,a._)("button",{id:"category-edit-save",type:"button",class:"btn btn-success",onClick:s[4]||(s[4]=(...e)=>l.fnSave&&l.fnSave(...e))},"Сохранить")])])])])],512)),[[o.F8,e.bShowGroupEditWindow]])}var je={props:{},computed:{...j("bShowGroupEditWindow sGroupName sGroupColor")},data(){return{}},methods:{...(0,P.OI)(Y`fnSaveGroup`),fnSave(){this.fnSaveGroup(),this.bShowGroupEditWindow=!1},fnClose(){this.bShowGroupEditWindow=!1}}};const Je=(0,N.Z)(je,[["render",Ae]]);var ze=Je;const Ke=(0,a._)("div",{class:"block-overlay"},null,-1),Ze={id:"modal-ask-api-key",class:"modal show",tabindex:"-1"},$e={class:"modal-dialog"},qe={class:"modal-content"},Xe=(0,a._)("div",{class:"modal-header"},[(0,a._)("h5",{class:"modal-title"},"Данные репозитория")],-1),Qe={class:"modal-body",style:{height:"500px","overflow-y":"scroll"}},es={class:"modal-ask-api_list_buttons"},ss=(0,a._)("div",null,null,-1),ts={class:"mb-3"},os=(0,a._)("label",{for:"",class:"form-label"},"Логин",-1),as=(0,a._)("option",{value:"github"},"github",-1),ns=(0,a._)("option",{value:"webdav"},"webdav",-1),is=[as,ns],ls={class:"mb-3"},rs=(0,a._)("label",{for:"",class:"form-label"},"Название",-1),ds={class:"mb-3"},cs=(0,a._)("label",{for:"",class:"form-label"},"Логин",-1),us={class:"mb-3"},ps=(0,a._)("label",{for:"",class:"form-label"},"Репозиторий",-1),ms={class:"mb-3"},ks=(0,a._)("label",{for:"",class:"form-label"},"API Ключ",-1),bs={class:"mb-3"},fs=(0,a._)("label",{for:"",class:"form-label"},"URL",-1),_s={class:"mb-3"},ws=(0,a._)("label",{for:"",class:"form-label"},"Пользователь",-1),hs={class:"mb-3"},vs=(0,a._)("label",{for:"",class:"form-label"},"Пароль",-1),gs={class:"modal-ask-api_list_buttons"},ys=(0,a._)("div",null,null,-1),Ss={class:"list-repo-item_desc"},Ds={class:"list-repo-item_title"},Ts={class:"list-repo-item_type"},Rs={class:"list-repo-item_name"},Cs=(0,a._)("b",null,"login:",-1),Is=(0,a._)("b",null,"repo:",-1),Fs=(0,a._)("b",null,"key:",-1),Gs=(0,a._)("b",null,"url:",-1),Ws=(0,a._)("b",null,"username:",-1),Ls=(0,a._)("b",null,"password:",-1),Os={style:{display:"flex","align-items":"start"}},Es=["onClick"],xs=(0,a._)("i",{class:"bi bi-pencil"},null,-1),Us=[xs],Bs=["onClick"],Ms=(0,a._)("i",{class:"bi bi-trash"},null,-1),Ns=[Ms],Hs=(0,a._)("div",{style:{width:"32px",height:"29px"}},null,-1),Vs=(0,a._)("div",{style:{width:"32px",height:"29px"}},null,-1),Ps=["onClick"],Ys=(0,a._)("i",{class:"bi bi-star-fill"},null,-1),As=[Ys],js={class:"modal-footer"};function Js(e,s,t,i,l,r){return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",null,[Ke,(0,a._)("div",Ze,[(0,a._)("div",$e,[(0,a._)("div",qe,[Xe,(0,a._)("div",Qe,[null!==l.iEditIndex?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("div",es,[ss,(0,a._)("div",null,[(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=(...e)=>r.fnCancelRepo&&r.fnCancelRepo(...e))},"Отмена"),(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:s[1]||(s[1]=(...e)=>r.fnSaveRepo&&r.fnSaveRepo(...e))},"Сохранить")])]),(0,a._)("div",ts,[os,(0,a.wy)((0,a._)("select",{class:"form-control","onUpdate:modelValue":s[2]||(s[2]=e=>l.sFromType=e)},is,512),[[o.bM,l.sFromType]])]),(0,a._)("div",ls,[rs,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[3]||(s[3]=s=>e.sFormName=s)},null,512),[[o.nr,e.sFormName]])]),"github"==l.sFromType?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("div",ds,[cs,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[4]||(s[4]=e=>l.sFormLogin=e)},null,512),[[o.nr,l.sFormLogin]])]),(0,a._)("div",us,[ps,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[5]||(s[5]=e=>l.sFormRepo=e)},null,512),[[o.nr,l.sFormRepo]])]),(0,a._)("div",ms,[ks,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[6]||(s[6]=e=>l.sFormKey=e)},null,512),[[o.nr,l.sFormKey]])])],64)):(0,a.kq)("",!0),"webdav"==l.sFromType?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a._)("div",bs,[fs,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[7]||(s[7]=e=>l.sFormURL=e)},null,512),[[o.nr,l.sFormURL]])]),(0,a._)("div",_s,[ws,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[8]||(s[8]=s=>e.sFormUsername=s)},null,512),[[o.nr,e.sFormUsername]])]),(0,a._)("div",hs,[vs,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[9]||(s[9]=s=>e.sFormPassword=s)},null,512),[[o.nr,e.sFormPassword]])])],64)):(0,a.kq)("",!0)],64)):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a._)("div",gs,[ys,(0,a._)("div",null,[(0,a._)("button",{class:"btn btn-secondary",onClick:s[10]||(s[10]=(...e)=>r.fnExport&&r.fnExport(...e))},"Экспортировать"),(0,a._)("button",{class:"btn btn-danger",onClick:s[11]||(s[11]=(...e)=>r.fnCleanRepo&&r.fnCleanRepo(...e))},"Очистить"),(0,a._)("button",{class:"btn btn-success",onClick:s[12]||(s[12]=(...e)=>r.fnNewRepo&&r.fnNewRepo(...e))},"Добавить")])]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.aReposList,((s,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t,class:(0,n.C_)("list-repo-item "+(e.iSelectedRepoIndex==t?"active":""))},[s?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("div",Ss,[(0,a._)("div",Ds,[(0,a._)("div",Ts,(0,n.zw)(s.type),1),(0,a._)("div",Rs,(0,n.zw)(s.name),1)]),"github"==s.type?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("div",null,[Cs,(0,a.Uk)(" "+(0,n.zw)(s.login),1)]),(0,a._)("div",null,[Is,(0,a.Uk)(" "+(0,n.zw)(s.repo),1)]),(0,a._)("div",null,[Fs,(0,a.Uk)(" "+(0,n.zw)(s.key),1)])],64)):(0,a.kq)("",!0),"webdav"==s.type?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a._)("div",null,[Gs,(0,a.Uk)(" "+(0,n.zw)(s.url),1)]),(0,a._)("div",null,[Ws,(0,a.Uk)(" "+(0,n.zw)(s.username),1)]),(0,a._)("div",null,[Ls,(0,a.Uk)(" "+(0,n.zw)(s.password),1)])],64)):(0,a.kq)("",!0)]),(0,a._)("div",Os,["localstorage"!=s.type?((0,a.wg)(),(0,a.iD)(a.HY,{key:0},[(0,a._)("button",{class:"btn btn-success",onClick:e=>r.fnEditRepo(t),title:"Редактировать"},Us,8,Es),(0,a._)("button",{class:"btn btn-danger",onClick:e=>r.fnRemoveRepo(t),title:"Удалить"},Ns,8,Bs)],64)):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[Hs,Vs],64)),(0,a._)("button",{class:"btn btn-info",onClick:e=>r.fnSelectRepo(t),title:"Выбрать"},As,8,Ps)])],64)):(0,a.kq)("",!0)],2)))),128))],64))]),(0,a._)("div",js,[(0,a._)("button",{class:"btn btn-success",onClick:s[13]||(s[13]=e=>r.fnAcceptRepo())},"Выбрать")])])])])],512)),[[o.F8,e.bShowRepoWindow]])}var zs={name:"AskAPIWindow",components:{},computed:{...(0,P.rn)(Y`iSelectedRepoIndex bShowRepoWindow`),...(0,P.Se)(Y`aReposList`)},data(){return{iEditIndex:null,sFormLogin:"",sFormRepo:"",sFormKey:"",sFormURL:"",sFromType:"github"}},methods:{...(0,P.OI)(Y`fnReposRemove fnReposSelect fnReposClean fnReposUpdate`),...(0,P.nv)(Y`fnPrepareRepo`),fnSaveRepo(){if(this.sFormName){var e={name:this.sFormName,login:this.sFormLogin,repo:this.sFormRepo,key:this.sFormKey,type:this.sFromType,url:this.sFormURL,username:this.sFormUsername,password:this.sFormPassword};this.fnReposUpdate({iIndex:this.iEditIndex,oObj:e}),this.iEditIndex=null}else alert("Надо заполнить поле - Название")},fnNewRepo(){this.iEditIndex=-1,this.sFormName="",this.sFormLogin="",this.sFormRepo="",this.sFormKey="",this.sFormType="github",this.sFormURL="",this.sFormUsername="",this.sFormPassword=""},fnEditRepo(e){this.iEditIndex=e;var s=this.aReposList[this.iEditIndex];this.sFormName=s.name,this.sFormLogin=s.login,this.sFormRepo=s.repo,this.sFormKey=s.key,this.sFormType=s.type,this.sFormURL=s.url,this.sFormUsername=s.username,this.sFormPassword=s.password},fnRemoveRepo(e){this.fnReposRemove(e)},fnSelectRepo(e){this.fnReposSelect(e)},fnCleanRepo(){this.fnReposClean()},fnCancelRepo(){this.iEditIndex=null},fnAcceptRepo(){if(!this.aReposList[this.iSelectedRepoIndex])return alert("Нужно выбрать репозиторий");this.fnPrepareRepo()},fnExport(){J("database",JSON.stringify(this.aReposList))}},created(){}};const Ks=(0,N.Z)(zs,[["render",Js]]);var Zs=Ks;const $s={class:"toast-container position-fixed top-0 end-0 p-3"},qs={class:"toast fade show",role:"alert","aria-live":"assertive","aria-atomic":"true"},Xs=(0,a._)("div",{class:"toast-header"},[(0,a._)("strong",{class:"me-auto"},"Сохранено"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast","aria-label":"Close"})],-1),Qs=(0,a._)("div",{class:"toast-body"}," Данные были сохранены ",-1),et=[Xs,Qs];function st(e,s,t,n,i,l){return(0,a.wg)(),(0,a.iD)("div",$s,[(0,a.wy)((0,a._)("div",qs,et,512),[[o.F8,e.bShowSaveToast]])])}var tt={name:"SavedToast",components:{},computed:{...j("bShowSaveToast")},data(){return{}},watch:{bShowSaveToast(e,s){e&&setTimeout((()=>{this.bShowSaveToast=!1}),2e3)}}};const ot=(0,N.Z)(tt,[["render",st]]);var at=ot;const nt={class:"loader"},it=(0,a._)("div",{class:"center"},[(0,a._)("div",{class:"lds-dual-ring"})],-1),lt=[it];function rt(e,s,t,n,i,l){return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",nt,lt,512)),[[o.F8,e.bShowLoader]])}var dt={computed:{...(0,P.rn)(Y`bShowLoader`)}};const ct=(0,N.Z)(dt,[["render",rt]]);var ut=ct,pt={name:"App",components:{dropdown:V,loader:ut,saved_toast:at,repo_window:Zs,draggable_tasks_list:Z,edit_task_window:_e,edit_block_window:We,edit_group_window:ze},computed:{...(0,P.Se)(Y`aCurrentGroupBlocks oCurrentGroup fnGetBlockTasks aTasks`),...j("bShowSaveToast sSelectedGroupID sSelectedTaskID sMode sTasksFilter sTaskMenuX sTaskMenuY bShowTaskMenu oMenuTask bShowRepoWindow"),aGroups(){return this.$store.getters.fnFilterGroups(this.sGroupsFilter)}},data(){return{aMenu:[{id:"repo-window",title:"Выбрать репозиторий",icon:"bi-person-fill"},{id:"tasks",title:"Задачи",icon:"bi-layout-three-columns"}],sGroupsFilter:"",aGroupsDropdownMenu:[{id:"add",title:'<i class="bi bi-plus-lg"></i> Добавить группу'},{id:"edit",title:'<i class="bi bi-pencil"></i> Редактировать'},{id:"delete",title:'<i class="bi bi-trash"></i> Удалить'}],aBlockDropdownMenu:[{id:"add-task",title:'<i class="bi bi-plus-lg"></i> Добавить задачу'},{id:"edit",title:'<i class="bi bi-pencil"></i> Редактировать'},{id:"delete",title:'<i class="bi bi-trash"></i> Удалить'}],aGroupsOptionsDropdownMenu:[{id:"add",title:'<i class="bi bi-plus-lg"></i> Добавить блок'}],aTasksDropdownMenu:[{id:"edit",title:'<i class="bi bi-pencil"></i> Редактировать'},{id:"delete",title:'<i class="bi bi-trash"></i> Удалить'}]}},methods:{...(0,P.OI)(Y`fnLoadRepos fnSelectGroup fnSelectTask fnOpenTaskEditWindow fnOpenBlockEditWindow fnOpenGroupEditWindow fnRemoveGroup fnRemoveBlock fnRemoveTask`),...(0,P.nv)(Y`fnSaveDatabase`),fnGroupClickItem(e){if("add"==e.id&&this.fnOpenGroupEditWindow({}),"edit"==e.id){if(!this.oCurrentGroup)return;this.fnOpenGroupEditWindow(this.oCurrentGroup)}"delete"==e.id&&this.fnRemoveGroup(this.oCurrentGroup.id)},fnClickLeftMenu(e){"repo-window"==e.id&&(this.bShowRepoWindow=!0),"tasks"==e.id&&(this.sMode="tasks")},fnBlockClickItem(e,s){"add-task"==e.id&&this.fnOpenTaskEditWindow({block_id:s.id}),"edit"==e.id&&this.fnOpenBlockEditWindow(s),"delete"==e.id&&this.fnRemoveBlock(s.id)},fnGroupOptionsClickItem(e,s){"add"==e.id&&this.fnOpenBlockEditWindow({group_id:this.oCurrentGroup.id})},fnTaskClickItem(e){"edit"==e.id&&this.fnOpenTaskEditWindow(this.oMenuTask),"delete"==e.id&&this.fnRemoveTask(this.oMenuTask.id),this.bShowTaskMenu=!1},fnSaveAll(){this.fnSaveDatabase(),this.bShowSaveToast=!0}},created(){var e=this;this.fnLoadRepos(),document.addEventListener("keydown",(s=>{s.ctrlKey&&83===s.keyCode&&(s.preventDefault(),e.fnSaveAll())})),window.addEventListener("click",(s=>{this.bShowTaskMenu&&(e.$refs.task_menu.contains(s.target)||(this.bShowTaskMenu=!1))}))}};const mt=(0,N.Z)(pt,[["render",y]]);var kt=mt,bt=(t(7658),t(7327)),ft=t(13),_t=t(8228),wt=t(6704);class ht{static fnInit(e){ht.oRepoItem=e,"github"==e.type&&ht.fnInitGit(),"webdav"==e.type&&ht.fnInitWebdav(),e.type}static fnInitGit(){ht.octokit=new ft.v({auth:ht.oRepoItem.key})}static fnInitWebdav(){ht.webdav=(0,_t.createClient)(ht.oRepoItem.url,{username:ht.oRepoItem.username,password:ht.oRepoItem.password})}static fnReadFileJSON(e){return new Promise(((s,t)=>{this.fnReadFile(e).then((({sData:e})=>{s(JSON.parse(e))})).catch((e=>{t(e)}))}))}static fnReadFile(e){return"localstorage"==ht.oRepoItem.type?ht.fnReadFileLocalStorage(e):"github"==ht.oRepoItem.type?ht.fnReadFileGithub(e):"webdav"==ht.oRepoItem.type?ht.fnReadFileWebdav(e):void 0}static fnWriteFileJSON(e,s){return this.fnWriteFile(e,JSON.stringify(s,null,4))}static fnWriteFile(e,s){return"localstorage"==ht.oRepoItem.type?ht.fnWriteFileLocalStorage(e,s):"github"==ht.oRepoItem.type?ht.fnWriteFileGithub(e,s):"webdav"==ht.oRepoItem.type?ht.fnWriteFileWebdav(e,s):void 0}static fnCreateDir(e){if("webdav"==ht.oRepoItem.type)return ht.fnCreateDirWebdav(e)}static fnCreateDirWebdav(e){return new Promise(((s,t)=>{_l(">>>",e),ht.webdav.createDirectory(e),s()}))}static fnReadFileLocalStorage(e){return new Promise((async(s,t)=>{var o=localStorage.getItem(e);s({sData:o,sSHA:""})}))}static fnReadFileWebdav(e){ht.oRepoItem;return new Promise((async(s,t)=>{try{var o=await ht.webdav.getFileContents(e),a=new TextDecoder("utf-8"),n=a.decode(o);ht.oSHA[e]="",s({sData:n,sSHA:""})}catch(i){console.error(i),t(i)}}))}static fnReadFileGithub(e){return new Promise((async(s,t)=>{var o=ht.oRepoItem;return console.log("read",o),e=e.replace(/^\/+/,""),ht.octokit.rest.repos.getContent({owner:o.login,repo:o.repo,path:e}).then((({data:t})=>{var o=(0,wt.Jx)(t.content);ht.oSHA[e]=t.sha,console.log(ht.oSHA),s({sData:o,sSHA:t.sha})})).catch((e=>{console.error(e),t(e)}))}))}static fnWriteFileLocalStorage(e,s){return new Promise((async(t,o)=>{localStorage.setItem(e,s),t()}))}static fnWriteFileGithub(e,s,t=null){return new Promise((async(o,a)=>{var n=ht.oRepoItem;return console.log("write",n),e=e.replace(/^\/+/,""),ht.octokit.rest.repos.createOrUpdateFileContents({owner:n.login,repo:n.repo,path:e,sha:t||ht.oSHA[e],message:ht.fnGetUpdateMessage(),content:(0,wt.cv)(s)}).then((()=>{o()})).catch((e=>{console.error(e),a(e)}))}))}static fnWriteFileWebdav(e,s){return new Promise((async(t,o)=>{ht.oRepoItem;return new Promise((async(t,o)=>{try{var a=new TextEncoder,n=a.encode(s);await ht.webdav.putFileContents(e,n,{contentLength:!1,overwrite:!0}),t()}catch(i){o(i)}}))}))}static fnGetUpdateMessage(){return"update: "+new Date}}(0,bt.Z)(ht,"octokit",null),(0,bt.Z)(ht,"oSHA",{}),(0,bt.Z)(ht,"webdav",null),(0,bt.Z)(ht,"oRepoItem",null);const vt="tasks-database.json";var gt=(0,P.MT)({state(){return{oDatabase:{tasks_groups_last_id:0,tasks_groups:[],tasks_blocks_last_id:0,tasks_blocks:[],tasks_last_id:0,tasks:[],archived_tasks_last_id:0,archived_tasks:[]},sSelectedGroupID:null,sSelectedTaskID:null,bShowSaveToast:!1,sTasksFilter:"",bShowRepoWindow:!0,aDefaultRepoList:[{type:"localstorage",name:"Локальное хранилище"}],aReposList:[],iSelectedRepoIndex:null,bShowTaskEditWindow:!1,sEditTaskID:null,sTaskBlockID:"",sTaskBlockName:"",sTaskName:"",sTaskShortDescription:"",sTaskFullDescription:"",sTaskColor:"",sTaskUseColor:"",bShowBlockEditWindow:!1,sEditBlockID:null,sBlockName:"",bShowGroupEditWindow:!1,sEditGroupID:null,sGroupName:"",sGroupColor:"",bShowTaskMenu:!1,sTaskMenuX:"",sTaskMenuY:"",oMenuTask:null,sMode:"tasks"}},mutations:{fnReposRemove(e,s){e.aReposList.splice(s-e.aDefaultRepoList.length,1),localStorage.setItem("aReposList",JSON.stringify(e.aReposList))},fnReposSelect(e,s){e.iSelectedRepoIndex=s},fnReposClean(e){e.aReposList=[],localStorage.setItem("aReposList",JSON.stringify(e.aReposList))},fnReposUpdate(e,{iIndex:s,oObj:t}){-1==s?e.aReposList.push(t):e.aReposList.splice(s-e.aDefaultRepoList.length,1,t),localStorage.setItem("aReposList",JSON.stringify(e.aReposList))},fnLoadRepos(e){try{e.aReposList=JSON.parse(localStorage.getItem("aReposList")||"[]")}catch(s){}},fnUpdateDatabase(e,s){e.oDatabase=s},fnHideRepoWindow(e){e.bShowRepoWindow=!1},fnShowRepoWindow(e){e.bShowRepoWindow=!0},fnShowLoader(e){e.bShowLoader=!0},fnHideLoader(e){e.bShowLoader=!1},fnUpdateVar(e,{sName:s,sV:t}){e[s]=t},fnSelectGroup(e,s){e.sSelectedGroupID=s},fnSelectTask(e,s){e.sSelectedTaskID=s},fnUpdateTasks(e,s){e.oDatabase.tasks=s},fnUpdateTasksListForBlock(e,{sBlockID:s,aList:t}){for(var o of(console.log({sBlockID:s,aList:t,tasks:e.oDatabase.tasks}),e.oDatabase.tasks=e.oDatabase.tasks.filter((e=>!~t.findIndex((s=>s.id==e.id)))),t))o.block_id=s;e.oDatabase.tasks=e.oDatabase.tasks.concat(t)},fnOpenTaskEditWindow(e,s){e.bShowTaskEditWindow=!0;var t=e.oDatabase.tasks_blocks.find((e=>e.id==s.block_id));e.sTaskBlockName=t.name,e.sTaskBlockID=t.id,s.id?(e.sEditTaskID=s.id,e.sTaskName=s.name,e.sTaskShortDescription=s.short_description,e.sTaskFullDescription=s.description,e.sTaskColor=s.color,e.sTaskUseColor=s.use_color):(e.sEditTaskID=null,e.sTaskName="",e.sTaskShortDescription="",e.sTaskFullDescription="",e.sTaskColor="",e.sTaskUseColor=!1)},fnSaveTask(e){if(null!==e.sEditTaskID){var s=e.oDatabase.tasks.find((s=>s.id==e.sEditTaskID));s.block_id=e.sTaskBlockID,s.name=e.sTaskName,s.short_description=e.sTaskShortDescription,s.description=e.sTaskFullDescription,s.color=e.sTaskColor,s.use_color=e.sTaskUseColor}else{s={};e.oDatabase.tasks_last_id++,s.id=e.oDatabase.tasks_last_id,s.block_id=e.sTaskBlockID,s.name=e.sTaskName,s.short_description=e.sTaskShortDescription,s.description=e.sTaskFullDescription,s.color=e.sTaskColor,s.use_color=e.sTaskUseColor,e.oDatabase.tasks.push(s)}},fnOpenBlockEditWindow(e,s){e.bShowBlockEditWindow=!0;var t=e.oDatabase.tasks_groups.find((e=>e.id==s.group_id));e.sBlockGroupID=t.id,s.id?(e.sEditBlockID=s.id,e.sBlockName=s.name):(e.sEditBlockID=null,e.sBlockName="")},fnSaveBlock(e){if(null!==e.sEditBlockID){var s=e.oDatabase.tasks_blocks.find((s=>s.id==e.sEditBlockID));s.group_id=e.sBlockGroupID,s.name=e.sBlockName}else{s={};e.oDatabase.tasks_blocks_last_id++,s.id=e.oDatabase.tasks_blocks_last_id,s.group_id=e.sBlockGroupID,s.name=e.sBlockName,e.oDatabase.tasks_blocks.push(s)}},fnOpenGroupEditWindow(e,s){e.bShowGroupEditWindow=!0,s.id?(e.sEditGroupID=s.id,e.sGroupName=s.name,e.sGroupColor=s.color):(e.sEditGroupID=null,e.sGroupName="",e.sGroupColor="")},fnSaveGroup(e){if(null!==e.sEditGroupID){var s=e.oDatabase.tasks_groups.find((s=>s.id==e.sEditGroupID));s.name=e.sGroupName,s.color=e.sGroupColor}else{s={};e.oDatabase.tasks_groups_last_id++,s.id=e.oDatabase.tasks_groups_last_id,s.name=e.sGroupName,s.color=e.sGroupColor,e.oDatabase.tasks_groups.push(s)}},fnRemoveGroup(e,s){var t=e.oDatabase.tasks_groups.findIndex((e=>e.id==s));e.oDatabase.tasks_groups.splice(t,1)},fnRemoveBlock(e,s){var t=e.oDatabase.tasks_blocks.findIndex((e=>e.id==s));e.oDatabase.tasks_blocks.splice(t,1)},fnRemoveTask(e,s){var t=e.oDatabase.tasks.findIndex((e=>e.id==s));e.oDatabase.tasks.splice(t,1)}},actions:{fnPrepareRepo({commit:e,state:s,dispatch:t,getters:o}){e("fnHideRepoWindow"),ht.fnInit(o.oCurrentRepo),t("fnLoadDatabase")},fnSaveDatabase({commit:e,state:s}){return ht.fnWriteFileJSON(vt,s.oDatabase).catch((()=>{ht.fnReadFile(vt).then((()=>ht.fnWriteFileJSON(vt,s.oDatabase)))}))},fnLoadDatabase({commit:e,state:s}){e("fnShowLoader"),ht.fnReadFileJSON(vt).then((s=>{e("fnUpdateDatabase",s),e("fnHideLoader")})).catch((t=>{((t+"").match(/Cannot destructure property/)||(t+"").match(/Not Found/))&&ht.fnWriteFileJSON(vt,s.oDatabase).then((()=>{ht.fnReadFileJSON(vt).then((s=>{e("fnUpdateDatabase",s),e("fnHideLoader")}))}))}))}},getters:{aReposList(e){return e.aDefaultRepoList.concat(e.aReposList)},oCurrentRepo(e,s){return s.aReposList[e.iSelectedRepoIndex]},fnFilterGroups:e=>s=>e.oDatabase.tasks_groups.filter((e=>~e.name.indexOf(s))),aGroups(e){return e.oDatabase.tasks_groups},aTasks(e){return e.oDatabase.tasks},oCurrentGroup(e){return e.oDatabase.tasks_groups.find((s=>s.id==e.sSelectedGroupID))},aCurrentGroupBlocks(e){return e.oDatabase.tasks_blocks.filter((s=>s.group_id==e.sSelectedGroupID))},fnGetBlockTasks:e=>s=>e.oDatabase.tasks.filter((t=>t.block_id==s&&~t.name.indexOf(e.sTasksFilter))),fnGetBlock:e=>s=>e.oDatabase.tasks_blocks.filter((e=>e.block_id==s))}});(0,o.ri)(kt).use(gt).mount("#app")}},s={};function t(o){var a=s[o];if(void 0!==a)return a.exports;var n=s[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(s,o,a,n){if(!o){var i=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],n=e[c][2];for(var l=!0,r=0;r<o.length;r++)(!1&n||i>=n)&&Object.keys(t.O).every((function(e){return t.O[e](o[r])}))?o.splice(r--,1):(l=!1,n<i&&(i=n));if(l){e.splice(c--,1);var d=a();void 0!==d&&(s=d)}}return s}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,a,n]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var o in s)t.o(s,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:s[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(s){return 0===e[s]};var s=function(s,o){var a,n,i=o[0],l=o[1],r=o[2],d=0;if(i.some((function(s){return 0!==e[s]}))){for(a in l)t.o(l,a)&&(t.m[a]=l[a]);if(r)var c=r(t)}for(s&&s(o);d<i.length;d++)n=i[d],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(c)},o=self["webpackChunkwapp_simple_todo_vue"]=self["webpackChunkwapp_simple_todo_vue"]||[];o.forEach(s.bind(null,0)),o.push=s.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(1140)}));o=t.O(o)})();
//# sourceMappingURL=app.343f5344.js.map